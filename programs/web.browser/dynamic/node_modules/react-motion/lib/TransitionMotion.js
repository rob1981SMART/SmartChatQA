function module(e,t,a){"use strict";t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},n=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}();function l(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,o=l(e("./mapToZero")),f,d=l(e("./stripStyle")),c,y=l(e("./stepper")),p,m=l(e("./mergeDiff")),v,h=l(e("performance-now")),S,g=l(e("raf")),k,P=l(e("./shouldStopAnimation")),b,I=l(e("react")),T,w=l(e("prop-types")),O=1e3/60;function j(e,t,a){var r=t;return null==r?e.map((function(e,t){return{key:e.key,data:e.data,style:a[t]}})):e.map((function(e,t){for(var n=0;n<r.length;n++)if(r[n].key===e.key)return{key:r[n].key,data:r[n].data,style:a[t]};return{key:e.key,data:e.data,style:a[t]}}))}function D(e,t,a,r){if(r.length!==t.length)return!1;for(var n=0;n<r.length;n++)if(r[n].key!==t[n].key)return!1;for(var n=0;n<r.length;n++)if(!P.default(e[n],t[n].style,a[n]))return!1;return!0}function V(e,t,a,r,n,l,i,u,s){for(var f=m.default(r,n,(function(e,r){var n=t(r);return null==n?(a({key:r.key,data:r.data}),null):P.default(l[e],n,i[e])?(a({key:r.key,data:r.data}),null):{key:r.key,data:r.data,style:n}})),d=[],c=[],y=[],p=[],v=0;v<f.length;v++){for(var h=f[v],S=null,g=0;g<r.length;g++)if(r[g].key===h.key){S=g;break}if(null==S){var k=e(h);d[v]=k,y[v]=k;var b=o.default(h.style);c[v]=b,p[v]=b}else d[v]=l[S],y[v]=u[S],c[v]=i[S],p[v]=s[S]}return[f,d,c,y,p]}var L=function(e){function t(a){var n=this;i(this,t),e.call(this,a),this.unmounting=!1,this.animationID=null,this.prevTime=0,this.accumulatedTime=0,this.unreadPropStyles=null,this.clearUnreadPropStyle=function(e){for(var t=V(n.props.willEnter,n.props.willLeave,n.props.didLeave,n.state.mergedPropsStyles,e,n.state.currentStyles,n.state.currentVelocities,n.state.lastIdealStyles,n.state.lastIdealVelocities),a=t[0],l=t[1],i=t[2],u=t[3],s=t[4],o=0;o<e.length;o++){var f=e[o].style,d=!1;for(var c in f)if(Object.prototype.hasOwnProperty.call(f,c)){var y=f[c];"number"==typeof y&&(d||(d=!0,l[o]=r({},l[o]),i[o]=r({},i[o]),u[o]=r({},u[o]),s[o]=r({},s[o]),a[o]={key:a[o].key,data:a[o].data,style:r({},a[o].style)}),l[o][c]=y,i[o][c]=0,u[o][c]=y,s[o][c]=0,a[o].style[c]=y)}}n.setState({currentStyles:l,currentVelocities:i,mergedPropsStyles:a,lastIdealStyles:u,lastIdealVelocities:s})},this.startAnimationIfNecessary=function(){n.unmounting||(n.animationID=g.default((function(e){if(!n.unmounting){var t=n.props.styles,a="function"==typeof t?t(j(n.state.mergedPropsStyles,n.unreadPropStyles,n.state.lastIdealStyles)):t;if(D(n.state.currentStyles,a,n.state.currentVelocities,n.state.mergedPropsStyles))return n.animationID=null,void(n.accumulatedTime=0);var r=e||h.default(),l=r-n.prevTime;if(n.prevTime=r,n.accumulatedTime=n.accumulatedTime+l,n.accumulatedTime>10*O&&(n.accumulatedTime=0),0===n.accumulatedTime)return n.animationID=null,void n.startAnimationIfNecessary();for(var i=(n.accumulatedTime-Math.floor(n.accumulatedTime/O)*O)/O,u=Math.floor(n.accumulatedTime/O),s=V(n.props.willEnter,n.props.willLeave,n.props.didLeave,n.state.mergedPropsStyles,a,n.state.currentStyles,n.state.currentVelocities,n.state.lastIdealStyles,n.state.lastIdealVelocities),o=s[0],f=s[1],d=s[2],c=s[3],p=s[4],m=0;m<o.length;m++){var v=o[m].style,S={},g={},k={},P={};for(var b in v)if(Object.prototype.hasOwnProperty.call(v,b)){var I=v[b];if("number"==typeof I)S[b]=I,g[b]=0,k[b]=I,P[b]=0;else{for(var T=c[m][b],w=p[m][b],L=0;L<u;L++){var _=y.default(O/1e3,T,w,I.val,I.stiffness,I.damping,I.precision);T=_[0],w=_[1]}var E=y.default(O/1e3,T,w,I.val,I.stiffness,I.damping,I.precision),R=E[0],q=E[1];S[b]=T+(R-T)*i,g[b]=w+(q-w)*i,k[b]=T,P[b]=w}}c[m]=k,p[m]=P,f[m]=S,d[m]=g}n.animationID=null,n.accumulatedTime-=u*O,n.setState({currentStyles:f,currentVelocities:d,lastIdealStyles:c,lastIdealVelocities:p,mergedPropsStyles:o}),n.unreadPropStyles=null,n.startAnimationIfNecessary()}})))},this.state=this.defaultState()}return u(t,e),n(t,null,[{key:"propTypes",value:{defaultStyles:w.default.arrayOf(w.default.shape({key:w.default.string.isRequired,data:w.default.any,style:w.default.objectOf(w.default.number).isRequired})),styles:w.default.oneOfType([w.default.func,w.default.arrayOf(w.default.shape({key:w.default.string.isRequired,data:w.default.any,style:w.default.objectOf(w.default.oneOfType([w.default.number,w.default.object])).isRequired}))]).isRequired,children:w.default.func.isRequired,willEnter:w.default.func,willLeave:w.default.func,didLeave:w.default.func},enumerable:!0},{key:"defaultProps",value:{willEnter:function e(t){return d.default(t.style)},willLeave:function e(){return null},didLeave:function e(){}},enumerable:!0}]),t.prototype.defaultState=function e(){var t=this.props,a=t.defaultStyles,r=t.styles,n=t.willEnter,l=t.willLeave,i=t.didLeave,u="function"==typeof r?r(a):r,s=void 0;s=null==a?u:a.map((function(e){for(var t=0;t<u.length;t++)if(u[t].key===e.key)return u[t];return e}));var f=null==a?u.map((function(e){return d.default(e.style)})):a.map((function(e){return d.default(e.style)})),c=null==a?u.map((function(e){return o.default(e.style)})):a.map((function(e){return o.default(e.style)})),y=V(n,l,i,s,u,f,c,f,c),p=y[0],m,v,h,S;return{currentStyles:y[1],currentVelocities:y[2],lastIdealStyles:y[3],lastIdealVelocities:y[4],mergedPropsStyles:p}},t.prototype.componentDidMount=function e(){this.prevTime=h.default(),this.startAnimationIfNecessary()},t.prototype.componentWillReceiveProps=function e(t){this.unreadPropStyles&&this.clearUnreadPropStyle(this.unreadPropStyles);var a=t.styles;this.unreadPropStyles="function"==typeof a?a(j(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.lastIdealStyles)):a,null==this.animationID&&(this.prevTime=h.default(),this.startAnimationIfNecessary())},t.prototype.componentWillUnmount=function e(){this.unmounting=!0,null!=this.animationID&&(g.default.cancel(this.animationID),this.animationID=null)},t.prototype.render=function e(){var t=j(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.currentStyles),a=this.props.children(t);return a&&I.default.Children.only(a)},t}(I.default.Component);t.default=L,a.exports=t.default}

