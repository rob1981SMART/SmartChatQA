function module(i,e,t){let n,r,o,a,s,l,u,c,d;t.link("@babel/runtime/helpers/objectWithoutProperties",{default(i){n=i}},0),t.link("meteor/meteor",{Meteor(i){r=i}},0),t.link("meteor/templating",{Template(i){o=i}},1),t.link("meteor/reactive-var",{ReactiveVar(i){a=i}},2),t.link("meteor/kadira:flow-router",{FlowRouter(i){s=i}},3),t.link("../../../../models",{ChatRoom(i){l=i}},4),t.link("../../../../ui-utils/client",{call(i){u=i}},5),t.link("./livechatReadOnly.html"),t.link("../../../../utils/client",{APIClient(i){c=i}},6),t.link("../../lib/stream/inquiry",{inquiryDataStream(i){d=i}},7),o.livechatReadOnly.helpers({inquiryOpen(){const i=o.instance().inquiry.get();return i&&"queued"===i.status},roomOpen(){const i=o.instance().room.get();return i&&!0===i.open},showPreview(){const i=o.instance().routingConfig.get();return i.previewRoom},isPreparing:()=>o.instance().preparing.get()}),o.livechatReadOnly.events({async"click .js-take-it"(i,e){i.preventDefault(),i.stopPropagation();const t=e.inquiry.get(),{_id:n}=t;await u("livechat:takeInquiry",n),e.loadInquiry(t.rid)}}),o.livechatReadOnly.onCreated((function(){this.rid=o.currentData().rid,this.room=new a,this.inquiry=new a,this.routingConfig=new a({}),this.preparing=new a(!0),this.updateInquiry=async i=>{let{clientAction:e}=i,t=n(i,["clientAction"]);if("removed"===e||!(await u("canAccessRoom",t.rid,r.userId())))return s.go("/home");this.inquiry.set(t)},r.call("livechat:getRoutingConfig",(i,e)=>{e&&this.routingConfig.set(e)}),this.loadInquiry=async i=>{this.preparing.set(!0);const{inquiry:e}=await c.v1.get("livechat/inquiries.getOne?roomId=".concat(i));this.inquiry.set(e),e&&e._id&&d.on(e._id,this.updateInquiry),this.preparing.set(!1)},this.autorun(()=>this.loadInquiry(this.rid)),this.autorun(()=>{this.room.set(l.findOne({_id:o.currentData().rid},{fields:{open:1}}))})})),o.livechatReadOnly.onDestroyed((function(){const i=this.inquiry.get();i&&i._id&&d.removeListener(i._id,this.updateInquiry)}))}

