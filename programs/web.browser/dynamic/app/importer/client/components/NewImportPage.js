function module(e,t,l){let n,a,r,o,i,c,s,m,u,p,d,h,g,E,y,f,_,k,x,F,S,w,I,C,b,T,R,v,U;function P(){const e=F(),t=w(),[l,P]=v(f(!1)),[B,L]=v(f("upload")),M=C("importerKey"),z=_(()=>R.get(M),[M]),K=S("FileUpload_MaxFileSize"),A=I("admin-import"),D=I("admin-import-new"),q=I("admin-import-prepare"),H=T("POST","uploadImportFile"),N=T("POST","downloadPublicImportFile");k(()=>{M&&!z&&D.replace()},[M,!z]);const O=U(),G=()=>{A.push()},W=e=>{D.replace({importerKey:e})},j=e=>{L(e)},[J,Q]=f([]),V=async e=>{e=e.originalEvent||e;let{files:t}=e.target;t&&0!==t.length||(t=(null!=e.dataTransfer?e.dataTransfer.files:void 0)||[]),Q(Array.from(t))},X=e=>()=>{Q(t=>t.filter(t=>t!==e))},Y=async()=>{P(!0);try{await Promise.all(Array.from(J,l=>new Promise(n=>{const a=new FileReader;a.readAsDataURL(l),a.onloadend=async()=>{try{await H({binaryContent:a.result.split(";base64,")[1],contentType:l.type,fileName:l.name,importerKey:M}),t({type:"success",message:e("File_uploaded_successfully")})}catch(r){b(r)}finally{n()}},a.onerror=()=>n()}))),q.push()}finally{P(!1)}},[Z,$]=v(f("")),ee=e=>{$(e.currentTarget.value)},te=async()=>{P(!0);try{await N({importerKey:M,fileUrl:Z}),t({type:"success",message:e("Import_requested_successfully")}),q.push()}catch(l){b(l)}finally{P(!1)}},[le,ne]=v(f("")),ae=e=>{ne(e.currentTarget.value)},re=async()=>{P(!0);try{await N({importerKey:M,fileUrl:le}),t({type:"success",message:e("Import_requested_successfully")}),q.push()}catch(l){b(l)}finally{P(!1)}},oe=E(),ie=E(),ce=E(),se="upload"===B&&Y||"url"===B&&te||"path"===B&&re;return y.createElement(x,{className:"page-settings"},y.createElement(x.Header,{title:e("Import_New_File")},y.createElement(r,null,y.createElement(a,{ghost:!0,onClick:G},y.createElement(s,{name:"back"})," ",e("Back_to_imports")),z&&y.createElement(a,{primary:!0,minHeight:"x40",disabled:l,onClick:se},l?y.createElement(h,{inheritColor:!0}):e("Import")))),y.createElement(x.ContentShadowScroll,null,y.createElement(n,{marginInline:"auto",marginBlock:"neg-x24",width:"full",maxWidth:"x580"},y.createElement(m,{block:"x24"},y.createElement(c,null,y.createElement(c.Label,{alignSelf:"stretch",htmlFor:oe},e("Import_Type")),y.createElement(c.Row,null,y.createElement(u,{id:oe,value:M,disabled:l,placeholder:e("Select_an_option"),onChange:W,options:R.getAll().map(t=>{let{key:l,name:n}=t;return[l,e(n)]})})),z&&y.createElement(c.Hint,null,e("Importer_From_Description",{from:e(z.name)}))),z&&y.createElement(c,null,y.createElement(c.Label,{alignSelf:"stretch",htmlFor:ie},e("File_Type")),y.createElement(c.Row,null,y.createElement(u,{id:ie,value:B,disabled:l,placeholder:e("Select_an_option"),onChange:j,options:[["upload",e("Upload")],["url",e("Public_URL")],["path",e("Server_File_Path")]]}))),z&&y.createElement(y.Fragment,null,"upload"===B&&y.createElement(y.Fragment,null,K>0?y.createElement(o,{type:"warning",marginBlock:"x16"},e("Importer_Upload_FileSize_Message",{maxFileSize:O(K)})):y.createElement(o,{type:"info",marginBlock:"x16"},e("Importer_Upload_Unlimited_FileSize")),y.createElement(c,null,y.createElement(c.Label,{alignSelf:"stretch",htmlFor:ce},e("Importer_Source_File")),y.createElement(c.Row,null,y.createElement(p,{type:"file",id:ce,onChange:V})),(null==J?void 0:J.length)>0&&y.createElement(c.Row,null,J.map((e,t)=>y.createElement(i,{key:t,onClick:X(e)},e.name))))),"url"===B&&y.createElement(c,null,y.createElement(c.Label,{alignSelf:"stretch",htmlFor:ce},e("File_URL")),y.createElement(c.Row,null,y.createElement(g,{id:ce,value:Z,onChange:ee}))),"path"===B&&y.createElement(c,null,y.createElement(c.Label,{alignSelf:"stretch",htmlFor:ce},e("File_Path")),y.createElement(c.Row,null,y.createElement(d,{id:ce,value:le,onChange:ae}))))))))}l.link("@rocket.chat/fuselage",{Box(e){n=e},Button(e){a=e},ButtonGroup(e){r=e},Callout(e){o=e},Chip(e){i=e},Field(e){c=e},Icon(e){s=e},Margins(e){m=e},Select(e){u=e},InputBox(e){p=e},TextInput(e){d=e},Throbber(e){h=e},UrlInput(e){g=e}},0),l.link("@rocket.chat/fuselage-hooks",{useUniqueId(e){E=e}},1),l.link("react",{default(e){y=e},useState(e){f=e},useMemo(e){_=e},useEffect(e){k=e}},2),l.link("../../../../client/components/basic/Page",{Page(e){x=e}},3),l.link("../../../../client/contexts/TranslationContext",{useTranslation(e){F=e}},4),l.link("../../../../client/contexts/SettingsContext",{useSetting(e){S=e}},5),l.link("../../../../client/contexts/ToastMessagesContext",{useToastMessageDispatch(e){w=e}},6),l.link("../../../../client/contexts/RouterContext",{useRoute(e){I=e},useRouteParameter(e){C=e}},7),l.link("../functions/showImporterException",{showImporterException(e){b=e}},8),l.link("../../../../client/contexts/ServerContext",{useEndpoint(e){T=e}},9),l.link("../index",{Importers(e){R=e}},10),l.link("../../../../client/hooks/useSafely",{useSafely(e){v=e}},11),l.link("../../../ui/client/views/app/components/hooks",{useFormatMemorySize(e){U=e}},12),l.exportDefault(P)}

