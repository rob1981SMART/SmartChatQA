function module(t,e,a){"use strict";e.__esModule=!0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},n=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}();function l(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s,u=l(t("./mapToZero")),c,f=l(t("./stripStyle")),p,d=l(t("./stepper")),m,y=l(t("performance-now")),h,v=l(t("raf")),S,I=l(t("./shouldStopAnimation")),b,T=l(t("react")),O,P=l(t("prop-types")),g=1e3/60;function w(t,e,a){for(var r=0;r<t.length;r++)if(!I.default(t[r],e[r],a[r]))return!1;return!0}var D=function(t){function e(a){var n=this;i(this,e),t.call(this,a),this.animationID=null,this.prevTime=0,this.accumulatedTime=0,this.unreadPropStyles=null,this.clearUnreadPropStyle=function(t){for(var e=n.state,a=e.currentStyles,l=e.currentVelocities,i=e.lastIdealStyles,o=e.lastIdealVelocities,s=!1,u=0;u<t.length;u++){var c=t[u],f=!1;for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var d=c[p];"number"==typeof d&&(f||(f=!0,s=!0,a[u]=r({},a[u]),l[u]=r({},l[u]),i[u]=r({},i[u]),o[u]=r({},o[u])),a[u][p]=d,l[u][p]=0,i[u][p]=d,o[u][p]=0)}}s&&n.setState({currentStyles:a,currentVelocities:l,lastIdealStyles:i,lastIdealVelocities:o})},this.startAnimationIfNecessary=function(){n.animationID=v.default((function(t){var e=n.props.styles(n.state.lastIdealStyles);if(w(n.state.currentStyles,e,n.state.currentVelocities))return n.animationID=null,void(n.accumulatedTime=0);var a=t||y.default(),r=a-n.prevTime;if(n.prevTime=a,n.accumulatedTime=n.accumulatedTime+r,n.accumulatedTime>10*g&&(n.accumulatedTime=0),0===n.accumulatedTime)return n.animationID=null,void n.startAnimationIfNecessary();for(var l=(n.accumulatedTime-Math.floor(n.accumulatedTime/g)*g)/g,i=Math.floor(n.accumulatedTime/g),o=[],s=[],u=[],c=[],f=0;f<e.length;f++){var p=e[f],m={},h={},v={},S={};for(var I in p)if(Object.prototype.hasOwnProperty.call(p,I)){var b=p[I];if("number"==typeof b)m[I]=b,h[I]=0,v[I]=b,S[I]=0;else{for(var T=n.state.lastIdealStyles[f][I],O=n.state.lastIdealVelocities[f][I],P=0;P<i;P++){var D=d.default(g/1e3,T,O,b.val,b.stiffness,b.damping,b.precision);T=D[0],O=D[1]}var V=d.default(g/1e3,T,O,b.val,b.stiffness,b.damping,b.precision),j=V[0],_=V[1];m[I]=T+(j-T)*l,h[I]=O+(_-O)*l,v[I]=T,S[I]=O}}u[f]=m,c[f]=h,o[f]=v,s[f]=S}n.animationID=null,n.accumulatedTime-=i*g,n.setState({currentStyles:u,currentVelocities:c,lastIdealStyles:o,lastIdealVelocities:s}),n.unreadPropStyles=null,n.startAnimationIfNecessary()}))},this.state=this.defaultState()}return o(e,t),n(e,null,[{key:"propTypes",value:{defaultStyles:P.default.arrayOf(P.default.objectOf(P.default.number)),styles:P.default.func.isRequired,children:P.default.func.isRequired},enumerable:!0}]),e.prototype.defaultState=function t(){var e=this.props,a=e.defaultStyles,r=e.styles,n=a||r().map(f.default),l=n.map((function(t){return u.default(t)}));return{currentStyles:n,currentVelocities:l,lastIdealStyles:n,lastIdealVelocities:l}},e.prototype.componentDidMount=function t(){this.prevTime=y.default(),this.startAnimationIfNecessary()},e.prototype.componentWillReceiveProps=function t(e){null!=this.unreadPropStyles&&this.clearUnreadPropStyle(this.unreadPropStyles),this.unreadPropStyles=e.styles(this.state.lastIdealStyles),null==this.animationID&&(this.prevTime=y.default(),this.startAnimationIfNecessary())},e.prototype.componentWillUnmount=function t(){null!=this.animationID&&(v.default.cancel(this.animationID),this.animationID=null)},e.prototype.render=function t(){var e=this.props.children(this.state.currentStyles);return e&&T.default.Children.only(e)},e}(T.default.Component);e.default=D,a.exports=e.default}

