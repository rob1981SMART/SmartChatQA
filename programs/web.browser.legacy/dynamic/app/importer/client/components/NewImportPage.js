function module(e,n,t){var r,l,a,o,c,i,u,s,f,m,p,d,h,g,E,x,k,v,y,_,w,F,S,b,I,C,T,R,U,P,B;function L(){var e=F(),n=b(),t=P(v(!1)),L=l(t,2),M=L[0],z=L[1],A=P(v("upload")),K=l(A,2),D=K[0],q=K[1],H=C("importerKey"),N=y((function(){return U.get(H)}),[H]),O=S("FileUpload_MaxFileSize"),G=I("admin-import"),W=I("admin-import-new"),j=I("admin-import-prepare"),J=R("POST","uploadImportFile"),Q=R("POST","downloadPublicImportFile");_((function(){H&&!N&&W.replace()}),[H,!N]);var V=B(),X=function(){G.push()},Y=function(e){W.replace({importerKey:e})},Z=function(e){q(e)},$=v([]),ee=l($,2),ne=ee[0],te=ee[1],re=function(){function e(e){var n;return r.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:e=e.originalEvent||e,(n=e.target.files)&&0!==n.length||(n=(null!=e.dataTransfer?e.dataTransfer.files:void 0)||[]),te(Array.from(n));case 4:case"end":return t.stop()}}return t}())}return e}(),le=function(e){return function(){te((function(n){return n.filter((function(n){return n!==e}))}))}},ae=function(){function t(){return r.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return z(!0),t.prev=1,t.next=4,r.awrap(Promise.all(Array.from(ne,(function(t){return new Promise((function(l){var a=new FileReader;a.readAsDataURL(t),a.onloadend=function(){function o(){return r.async(function(){function o(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.awrap(J({binaryContent:a.result.split(";base64,")[1],contentType:t.type,fileName:t.name,importerKey:H}));case 3:n({type:"success",message:e("File_uploaded_successfully")}),o.next=9;break;case 6:o.prev=6,o.t0=o.catch(0),T(o.t0);case 9:return o.prev=9,l(),o.finish(9);case 12:case"end":return o.stop()}}return o}(),null,null,[[0,6,9,12]])}return o}(),a.onerror=function(){return l()}}))}))));case 4:j.push();case 5:return t.prev=5,z(!1),t.finish(5);case 8:case"end":return t.stop()}}return t}(),null,null,[[1,,5,8]])}return t}(),oe=P(v("")),ce=l(oe,2),ie=ce[0],ue=ce[1],se=function(e){ue(e.currentTarget.value)},fe=function(){function t(){return r.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return z(!0),t.prev=1,t.next=4,r.awrap(Q({importerKey:H,fileUrl:ie}));case 4:n({type:"success",message:e("Import_requested_successfully")}),j.push(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),T(t.t0);case 11:return t.prev=11,z(!1),t.finish(11);case 14:case"end":return t.stop()}}return t}(),null,null,[[1,8,11,14]])}return t}(),me=P(v("")),pe=l(me,2),de=pe[0],he=pe[1],ge=function(e){he(e.currentTarget.value)},Ee=function(){function t(){return r.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return z(!0),t.prev=1,t.next=4,r.awrap(Q({importerKey:H,fileUrl:de}));case 4:n({type:"success",message:e("Import_requested_successfully")}),j.push(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),T(t.t0);case 11:return t.prev=11,z(!1),t.finish(11);case 14:case"end":return t.stop()}}return t}(),null,null,[[1,8,11,14]])}return t}(),xe=x(),ke=x(),ve=x(),ye="upload"===D&&ae||"url"===D&&fe||"path"===D&&Ee;return k.createElement(w,{className:"page-settings"},k.createElement(w.Header,{title:e("Import_New_File")},k.createElement(c,null,k.createElement(o,{ghost:!0,onClick:X},k.createElement(f,{name:"back"})," ",e("Back_to_imports")),N&&k.createElement(o,{primary:!0,minHeight:"x40",disabled:M,onClick:ye},M?k.createElement(g,{inheritColor:!0}):e("Import")))),k.createElement(w.ContentShadowScroll,null,k.createElement(a,{marginInline:"auto",marginBlock:"neg-x24",width:"full",maxWidth:"x580"},k.createElement(m,{block:"x24"},k.createElement(s,null,k.createElement(s.Label,{alignSelf:"stretch",htmlFor:xe},e("Import_Type")),k.createElement(s.Row,null,k.createElement(p,{id:xe,value:H,disabled:M,placeholder:e("Select_an_option"),onChange:Y,options:U.getAll().map((function(n){var t=n.key,r=n.name;return[t,e(r)]}))})),N&&k.createElement(s.Hint,null,e("Importer_From_Description",{from:e(N.name)}))),N&&k.createElement(s,null,k.createElement(s.Label,{alignSelf:"stretch",htmlFor:ke},e("File_Type")),k.createElement(s.Row,null,k.createElement(p,{id:ke,value:D,disabled:M,placeholder:e("Select_an_option"),onChange:Z,options:[["upload",e("Upload")],["url",e("Public_URL")],["path",e("Server_File_Path")]]}))),N&&k.createElement(k.Fragment,null,"upload"===D&&k.createElement(k.Fragment,null,O>0?k.createElement(i,{type:"warning",marginBlock:"x16"},e("Importer_Upload_FileSize_Message",{maxFileSize:V(O)})):k.createElement(i,{type:"info",marginBlock:"x16"},e("Importer_Upload_Unlimited_FileSize")),k.createElement(s,null,k.createElement(s.Label,{alignSelf:"stretch",htmlFor:ve},e("Importer_Source_File")),k.createElement(s.Row,null,k.createElement(d,{type:"file",id:ve,onChange:re})),(null==ne?void 0:ne.length)>0&&k.createElement(s.Row,null,ne.map((function(e,n){return k.createElement(u,{key:n,onClick:le(e)},e.name)}))))),"url"===D&&k.createElement(s,null,k.createElement(s.Label,{alignSelf:"stretch",htmlFor:ve},e("File_URL")),k.createElement(s.Row,null,k.createElement(E,{id:ve,value:ie,onChange:se}))),"path"===D&&k.createElement(s,null,k.createElement(s.Label,{alignSelf:"stretch",htmlFor:ve},e("File_Path")),k.createElement(s.Row,null,k.createElement(h,{id:ve,value:de,onChange:ge}))))))))}t.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){l=e}},1),t.link("@rocket.chat/fuselage",{Box:function(e){a=e},Button:function(e){o=e},ButtonGroup:function(e){c=e},Callout:function(e){i=e},Chip:function(e){u=e},Field:function(e){s=e},Icon:function(e){f=e},Margins:function(e){m=e},Select:function(e){p=e},InputBox:function(e){d=e},TextInput:function(e){h=e},Throbber:function(e){g=e},UrlInput:function(e){E=e}},0),t.link("@rocket.chat/fuselage-hooks",{useUniqueId:function(e){x=e}},1),t.link("react",{default:function(e){k=e},useState:function(e){v=e},useMemo:function(e){y=e},useEffect:function(e){_=e}},2),t.link("../../../../client/components/basic/Page",{Page:function(e){w=e}},3),t.link("../../../../client/contexts/TranslationContext",{useTranslation:function(e){F=e}},4),t.link("../../../../client/contexts/SettingsContext",{useSetting:function(e){S=e}},5),t.link("../../../../client/contexts/ToastMessagesContext",{useToastMessageDispatch:function(e){b=e}},6),t.link("../../../../client/contexts/RouterContext",{useRoute:function(e){I=e},useRouteParameter:function(e){C=e}},7),t.link("../functions/showImporterException",{showImporterException:function(e){T=e}},8),t.link("../../../../client/contexts/ServerContext",{useEndpoint:function(e){R=e}},9),t.link("../index",{Importers:function(e){U=e}},10),t.link("../../../../client/hooks/useSafely",{useSafely:function(e){P=e}},11),t.link("../../../ui/client/views/app/components/hooks",{useFormatMemorySize:function(e){B=e}},12),t.exportDefault(L)}

